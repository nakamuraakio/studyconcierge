<h3>チューター一覧</h3>

<div class="container-fluid">
<%= form_for(@user, url: select_tutor_update_path) do |f| %>
  <p>
    <% if current_user.tutor_request_exists %>
      申請を撤回する
    <% elsif current_user.tutor_id == 0 %>
      選択しない
    <% else %>
      現在選択中のチューターを解除する（担当チューターがいない間は報告・コメント機能がオフになります）
    <% end %>
    <%= f.radio_button :tutor_id, 0 %>
  </p>
  <table class="table">
    <thead>
    <tr>
      <th>名前</th>
      <th>プロフィール画像</th>
      <th>大学・学部・学年</th>
      <th></th>
      <th></th>
      <th>選択</th>
    </tr>
    </thead>
    <tbody>
    <% @tutors.each do |tutor| %>
    <tr>
      <th><%= tutor.name %></th>
      <td><%= image_tag url_for(:controller => 'tutors/registrations', :action => 'photo', :id => tutor.id), :height => '64', :width => '64', :class => 'img-circle' %></td>
      <td><%= tutor.university %></td>
      <td><%= link_to '詳細を見る', url_for(:controller => 'select_tutor', :action => 'show', :id => tutor.id) %></td>
      <td>
        あと<%= tutor.capacity - tutor.users.count %>人の指導ができます。
      </td>
      <td><label>
        <% if tutor.capacity - tutor.users.count == 0 || current_user.tutor_request_exists %>
          <%= f.radio_button :tutor_id, tutor.id, { :disabled => true } %>
        <% else %>
          <%= f.radio_button :tutor_id, tutor.id %>
        <% end %>
      </label></td>
    </tr>
    <% end %>
    </tbody>
  </table>

  <div class="actions">
    <%= f.submit "Update", data: { confirm: '本当にチューターを変更しますか？なるべく一人の人に長く見てもらいましょう。コメントが上限まで達していない報告があった場合変更前のチューターからのコメントは来なくなります。' } %>
  </div>
<% end %>
</div>

